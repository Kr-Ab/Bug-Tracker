(this.webpackJsonpbugtracker=this.webpackJsonpbugtracker||[]).push([[12],{91:function(e,t,a){"use strict";a.r(t);var l=a(1),n=a(0),c=a.n(n),r=a(3),s=a(11),m=a(5),o=a.n(m),i=a(6),d=a(8),u=a(4);function E(e){var t=e.props,a=e.commentsDetail,s=e.setCommentsDetail,m=Object(n.useContext)(r.a).user,E=Object(n.useState)([]),p=Object(l.a)(E,2),b=p[0],f=p[1],h=Object(n.useState)(""),g=Object(l.a)(h,2),N=g[0],v=g[1];Object(n.useEffect)((function(){f(a)}),[a]);Object(n.useEffect)((function(){var e;f((e=N,a.filter((function(t){var a={};for(var l in a.commenterName=t.commenterName,a.message=t.message,a.createAt=t.createAt,a)if(JSON.stringify(a[l]).toLowerCase().includes(e.toLowerCase()))return a})))),console.log(N)}),[N]);for(var w=Object(n.useState)(1),y=Object(l.a)(w,2),j=y[0],k=y[1],O=Object(n.useState)(1),C=Object(l.a)(O,1)[0],S=j*C,D=S-C,x=b.slice(D,S),A=[],I=1;I<=Math.ceil(b.length/C);I++)A.push(I);var T=Object(n.useState)(""),V=Object(l.a)(T,2),_=V[0],L=V[1];return c.a.createElement(u.a,null,c.a.createElement("div",null,c.a.createElement("h4",null," ","Add a comment","?"),c.a.createElement("textarea",{required:!0,rows:"1",cols:"50",className:"form-control  mb-4",value:_,onChange:function(e){e.preventDefault(),L(e.target.value)},type:"text",placeholder:"Your commnets goes here"}),c.a.createElement("button",{onClick:function(){o.a.post("".concat(i.a,"/api/global/ticket/addCommentToTicket"),{ticketId:t.ticketId,commenterId:m._id,commenterName:m.name,message:_},{params:{},headers:{"auth-token":window.sessionStorage.getItem("token")}}).then((function(e){d.e.fire({icon:"success",title:"Added comments with success"}),s(e.data.comments),L("")})).catch((function(e){d.e.fire({icon:"error",title:"Error! to add comment "}),console.log(e)}))},className:"btn btn-info"},"Add")),c.a.createElement("div",{className:"card"},c.a.createElement("div",{className:"card-header card-header-success"},c.a.createElement("h6",{className:"card-title "},"Tickets Comments"),c.a.createElement("p",{className:"card-category"},"All your cooments for this tickets")),c.a.createElement("div",{className:"card-body"},c.a.createElement("div",{className:"table-responsive"},c.a.createElement("div",{className:"input-group no-border w-100  d-flex flex-row-reverse"},c.a.createElement("div",{className:"input-group no-border w-50  "},c.a.createElement("input",{className:"form-control",type:"text",value:N,onChange:function(e){v(e.target.value)},placeholder:"Search"}),c.a.createElement("button",{type:"submit",class:"btn btn-white btn-round btn-just-icon"},c.a.createElement("i",{class:"material-icons"},"search"),c.a.createElement("div",{class:"ripple-container"})))),c.a.createElement("table",{className:"table "},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",{className:"font-weight-bold"},"Commenter"),c.a.createElement("th",{className:"font-weight-bold"},"Message"),c.a.createElement("th",{className:"font-weight-bold"},"Created at"))),c.a.createElement("tbody",null,x.map((function(e,t){return c.a.createElement("tr",{key:t},c.a.createElement("td",null,e.commenterName),c.a.createElement("td",null," ",e.message),c.a.createElement("td",null," ",e.createAt))}))),c.a.createElement("tfoot",null,c.a.createElement("tr",null,c.a.createElement("td",null,c.a.createElement("nav",null,c.a.createElement("ul",{className:"pagination"},A.map((function(e){return c.a.createElement("li",{key:e,className:"page-item"},c.a.createElement("a",{onClick:function(){return k(e)},className:"page-link"},e))}))))))))))))}function p(e){var t=e.historiesDetail,a=(e.setHistoriesDetail,Object(n.useState)([])),r=Object(l.a)(a,2),s=r[0],m=r[1],o=Object(n.useState)(""),i=Object(l.a)(o,2),d=i[0],E=i[1];Object(n.useEffect)((function(){m(t)}),[t]);Object(n.useEffect)((function(){var e;m((e=d,t.filter((function(t){var a={};for(var l in a.property=t.property,t.oldValue?a.oldValue=t.oldValue:a.oldValue="",a.newValue=t.newValue,a.dateChange=t.dateChange,a)if(JSON.stringify(a[l]).toLowerCase().includes(e.toLowerCase()))return a})))),console.log(d)}),[d]);for(var p=Object(n.useState)(1),b=Object(l.a)(p,2),f=b[0],h=b[1],g=Object(n.useState)(3),N=Object(l.a)(g,1)[0],v=f*N,w=v-N,y=s.slice(w,v),j=[],k=1;k<=Math.ceil(s.length/N);k++)j.push(k);return c.a.createElement(u.a,{className:"card"},c.a.createElement("div",{className:"card-header card-header-success"},c.a.createElement("h4",{className:"card-title "}," ","Tickets History"," "),c.a.createElement("p",{className:"card-category"},"All history information for this ticket")),c.a.createElement("div",{className:"card-body"},c.a.createElement("div",{className:"table-responsive"},c.a.createElement("div",{className:"input-group no-border w-100  d-flex flex-row-reverse"},c.a.createElement("div",{className:"input-group no-border w-50  "},c.a.createElement("input",{className:"form-control",type:"text",value:d,onChange:function(e){E(e.target.value)},placeholder:"Search"}),c.a.createElement("button",{type:"submit",className:"btn btn-white btn-round btn-just-icon"},c.a.createElement("i",{className:"material-icons"},"search"),c.a.createElement("div",{className:"ripple-container"})))),c.a.createElement("table",{className:"table "},c.a.createElement("thead",{className:" "},c.a.createElement("tr",null,c.a.createElement("th",{className:"font-weight-bold"},"Property"),c.a.createElement("th",{className:"font-weight-bold"},"Old Value"),c.a.createElement("th",{className:"font-weight-bold"},"New Value"),c.a.createElement("th",{className:"font-weight-bold"},"Data Changed"))),c.a.createElement("tbody",null,y.map((function(e,t){return c.a.createElement("tr",{key:t},c.a.createElement("td",null,e.property),c.a.createElement("td",null," ",e.oldValue),c.a.createElement("td",null," ",e.newValue),c.a.createElement("td",null," ",e.dateChange))}))),c.a.createElement("tfoot",null,c.a.createElement("tr",null,c.a.createElement("td",null,c.a.createElement("nav",null,c.a.createElement("ul",{className:"pagination"},j.map((function(e){return c.a.createElement("li",{key:e,className:"page-item"},c.a.createElement("a",{onClick:function(){return h(e)},className:"page-link"},e))})))))))))))}function b(e){var t=e.props,a=e.imagesDetail,s=e.setImagesDetail,m=Object(n.useContext)(r.a).user,E=Object(n.useState)([]),p=Object(l.a)(E,2),b=p[0],f=p[1],h=Object(n.useState)(""),g=Object(l.a)(h,2),N=g[0],v=g[1];Object(n.useEffect)((function(){f(a)}),[a]);Object(n.useEffect)((function(){var e;f((e=N,a.filter((function(t){var a={};for(var l in a.uploaderName=t.uploaderName,a.imageDescription=t.imageDescription,a.updatedAt=t.updatedAt,a)if(JSON.stringify(a[l]).toLowerCase().includes(e.toLowerCase()))return a}))))}),[N]);for(var w=Object(n.useState)(1),y=Object(l.a)(w,2),j=y[0],k=y[1],O=Object(n.useState)(1),C=Object(l.a)(O,1)[0],S=j*C,D=S-C,x=b.slice(D,S),A=[],I=1;I<=Math.ceil(b.length/C);I++)A.push(I);var T=Object(n.useState)(""),V=Object(l.a)(T,2),_=V[0],L=V[1],F=Object(n.useState)(""),M=Object(l.a)(F,2),J=M[0],H=M[1];return c.a.createElement(u.a,null,c.a.createElement("div",null,c.a.createElement("form",null,c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{htmlFor:"exampleFormControlFile1"},c.a.createElement("h4",{style:{display:"inline"}}," ","Add a Attachment?  "),c.a.createElement("i",{className:"material-icons"},"move_to_inbox"),"Click Here to add your images"),c.a.createElement("input",{id:"exampleFormControlFile1",type:"file",className:"w-100  btn btn-warning form-control-file",onChange:function(e){e.preventDefault(),H(e.target.files[0]),console.log(e.target.files[0])}}))),c.a.createElement("textarea",{type:"text",value:_,onChange:function(e){L(e.target.value)},className:"form-control mb-4",placeholder:"Description",rows:"1",cols:"50"}),c.a.createElement("button",{className:"btn btn-info",onClick:function(e){e.preventDefault();var a=new FormData;a.append("file",J),a.append("upload_preset","i7sy3ilg"),d.e.fire({icon:"info",title:"Uploading images... one second please "}),L(""),o.a.post("https://api.cloudinary.com/v1_1/imagereactstore/image/upload",a,{headers:{"content-type":"multipart/form-data"}}).then((function(e){console.log(e.data),o.a.post("".concat(i.a,"/api/global/ticket/addImageToTicket"),{url:e.data.url,filename:e.data.original_filename,imageDescription:_,id:e.data.public_id,ticketId:t.ticketId,uploaderName:m.name,uploaderId:m._id},{params:{},headers:{"auth-token":window.sessionStorage.getItem("token")}}).then((function(e){console.log(e.data),s(e.data.image),d.e.fire({icon:"success",title:"Added image with success"})})).catch((function(e){console.log(e),d.e.fire({icon:"error",title:"Error! to add image "})}))})).catch((function(e){console.log(e),d.e.fire({icon:"error",title:"Error! upload image please"})}))}},"Add")),c.a.createElement("div",{className:"card"},c.a.createElement("div",{className:"card-header card-header-success"},c.a.createElement("h6",{className:"card-title "},"Tickets Attachtment"," "),c.a.createElement("p",{className:"card-category"},"All files attached to this ticket")),c.a.createElement("div",{className:"card-body"},c.a.createElement("div",{className:"table-responsive"},c.a.createElement("div",{className:"input-group no-border w-100  d-flex flex-row-reverse"},c.a.createElement("div",{className:"input-group no-border w-50  "},c.a.createElement("input",{className:"form-control",type:"text",value:N,onChange:function(e){v(e.target.value)},placeholder:"Search"}),c.a.createElement("button",{type:"submit",class:"btn btn-white btn-round btn-just-icon"},c.a.createElement("i",{class:"material-icons"},"search"),c.a.createElement("div",{class:"ripple-container"})))),c.a.createElement("table",{className:"table "},c.a.createElement("thead",{className:"font-weight-bold"},c.a.createElement("tr",null,c.a.createElement("th",{className:"font-weight-bold"},"File"," "),c.a.createElement("th",{className:"font-weight-bold"},"Uploader"," "),c.a.createElement("th",{className:"font-weight-bold"},"Description"," "),c.a.createElement("th",{className:"font-weight-bold"},"Created"," "))),c.a.createElement("tbody",null,x.map((function(e,t){return c.a.createElement("tr",{key:t,className:""},c.a.createElement("td",{className:""},c.a.createElement("button",{type:"button",className:" btn btn-info ","data-toggle":"modal","data-target":"#"+t},"View Image"),c.a.createElement("div",{className:"modal fade",id:t,tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},c.a.createElement("div",{className:"modal-dialog",role:"document"},c.a.createElement("div",{className:"modal-content"},c.a.createElement("div",{className:"modal-header"},c.a.createElement("h5",{className:"modal-title",id:"exampleModalLabel"},"Image"),c.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},c.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),c.a.createElement("div",{className:"modal-body"},c.a.createElement("a",{href:e.url,download:!0},c.a.createElement("img",{width:"300px",src:e.url,alt:""}))),c.a.createElement("div",{className:"modal-footer"},c.a.createElement("button",{type:"button",className:"btn btn-danger","data-dismiss":"modal"},"Close")))))),c.a.createElement("td",null,e.uploaderName),c.a.createElement("td",null,e.imageDescription),c.a.createElement("td",null,e.updatedAt))}))),c.a.createElement("tfoot",null,c.a.createElement("tr",null,c.a.createElement("td",null,c.a.createElement("nav",null,c.a.createElement("ul",{className:"pagination"},A.map((function(e){return c.a.createElement("li",{key:e,className:"page-item"},c.a.createElement("a",{onClick:function(){return k(e)},className:"page-link"},e))}))))))))))))}t.default=function(e){var t=Object(n.useState)({}),a=Object(l.a)(t,2),r=a[0],m=a[1],d=Object(n.useState)([]),u=Object(l.a)(d,2),f=u[0],h=u[1],g=Object(n.useState)([]),N=Object(l.a)(g,2),v=N[0],w=N[1],y=Object(n.useState)([]),j=Object(l.a)(y,2),k=j[0],O=j[1];Object(n.useEffect)((function(){o.a.post("".concat(i.a,"/api/global/ticket/getTicketById"),{ticketId:e.ticketId},{params:{},headers:{"auth-token":window.sessionStorage.getItem("token")}}).then((function(e){console.log(e.data),m(e.data),h(e.data.image),w(e.data.comments),O(e.data.historial),console.log(e.data.historial)})).catch((function(e){console.log(e)}))}),[]);return c.a.createElement("div",null,c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"container-fluid"},c.a.createElement("div",{className:"row d-flex flex-row justify-content-center"},c.a.createElement("div",{className:"col-md-6 "},c.a.createElement("div",{className:"card"},c.a.createElement("div",{className:"card-header card-header-success"},c.a.createElement("h4",{className:"card-title "},"Details for this ticket"),c.a.createElement("button",{onClick:function(){Object(s.d)("/myTickets")},class:"btn btn-link  btn-sm   text-white"},c.a.createElement("i",{class:"material-icons"},"arrow_back"),"Back to list")),c.a.createElement("div",{className:"card-body"},c.a.createElement("div",{className:"table-responsive"},c.a.createElement("table",{className:"table table-sm"},c.a.createElement("tbody",{id:"tbody"},c.a.createElement("tr",null,c.a.createElement("td",null,c.a.createElement("h6",null," ","Ticket Title"),c.a.createElement("p",null,r.name)),c.a.createElement("td",null,c.a.createElement("h6",null,"Ticket Description"," "),c.a.createElement("p",null,r.description))),c.a.createElement("tr",null,c.a.createElement("td",null,c.a.createElement("h6",null,"Assigned Developer"," "),c.a.createElement("p",null,r.assignedDeveloper&&r.assignedDeveloper.devName)),c.a.createElement("td",null,c.a.createElement("h6",null,"Submiter"," "),r.submitter&&c.a.createElement("p",null,r.submitter.name))),c.a.createElement("tr",null,c.a.createElement("td",null,c.a.createElement("h6",null,"Project"," "),c.a.createElement("p",null,r.byProjectName)),c.a.createElement("td",null,c.a.createElement("h6",null,"Ticket Priority"," "),c.a.createElement("p",null,r.priority))),c.a.createElement("tr",null,c.a.createElement("td",null,c.a.createElement("h6",null,"Ticket Status"," "),c.a.createElement("p",null,r.status)),c.a.createElement("td",null,c.a.createElement("h6",null,"Ticket Type"," "),c.a.createElement("p",null,r.type))),c.a.createElement("tr",null,c.a.createElement("td",null,c.a.createElement("h6",null,"Created"," "),c.a.createElement("p",null,r.createdAt)),c.a.createElement("td",null,c.a.createElement("h6",null,"Updated"," "),c.a.createElement("p",null,r.updatedAt))))))))),c.a.createElement("div",{class:"col-md-6"},c.a.createElement(p,{historiesDetail:k,setHistoriesDetail:O})),c.a.createElement("div",{className:"col-md-6"},c.a.createElement(E,{props:e,commentsDetail:v,setCommentsDetail:w})),c.a.createElement("hr",null),c.a.createElement("div",{className:"col-md-6"},c.a.createElement(b,{props:e,imagesDetail:f,setImagesDetail:h}))))))}}}]);
//# sourceMappingURL=12.605df9d9.chunk.js.map